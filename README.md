# SberLab Hub

**SberLab Hub** — веб-платформа для публикации студенческих проектов НГУ от менторов Сбера, представляемая MVP в рамках зимнего хакатона. Студенты просматривают каталог проектов, задают вопросы и подают заявки. Менторы рассматривают заявки, утверждают или отклоняют кандидатов. Преподаватели могут просматривать проекты и участвовать в обсуждениях. Администраторы управляют пользователями и модерируют контент.

---

## 📋 Содержание

- [Возможности](#-возможности)
- [Технологический стек](#-технологический-стек)
- [Архитектура](#-архитектура)
- [Роли и права доступа](#-роли-и-права-доступа)
- [Быстрый старт](#-быстрый-старт)
- [Документация](#-документация)
- [Структура проекта](#-структура-проекта)
- [Скриншоты](#-скриншоты)
- [Лицензия](#-лицензия)

---

## 🚀 Возможности

### Для студентов
- 🔍 **Поиск проектов** с фильтрами по сложности, тегам, навыкам
- 🤖 **Семантический поиск** на базе GigaChat для умного поиска по описаниям
- 📝 **Подача заявок** на интересующие проекты
- 💬 **Q&A система** — публичные и приватные вопросы менторам
- 📊 **Отслеживание статуса** заявок и получение обратной связи

### Для менторов
- ✏️ **Создание и публикация** проектов для студентов
- 👥 **Управление заявками** — просмотр, одобрение, отклонение
- 💭 **Ответы на вопросы** студентов и преподавателей
- ⭐ **Обратная связь** студентам (промежуточная и финальная оценки)
- 📈 **Дашборд** с аналитикой по своим проектам

### Для преподавателей
- 👀 **Просмотр проектов** студентов
- ❓ **Участие в Q&A** — могут задавать вопросы менторам

### Для администраторов
- 🛡️ **Управление пользователями** — изменение ролей, удаление
- 📂 **Модерация проектов** — архивирование, удаление
- 🔐 **Allow list** для регистрации менторов/преподавателей/админов
- 📊 **Полный доступ** ко всем данным системы

---

## 🛠️ Технологический стек

### Frontend
| Технология | Версия | Назначение |
|------------|--------|------------|
| **React** | 18 | UI библиотека |
| **Vite** | 5 | Сборщик и dev-сервер |
| **MUI (Material-UI)** | 5 | Компоненты интерфейса |
| **React Router** | 6 | Маршрутизация |
| **Emotion** | 11 | CSS-in-JS стилизация |

### Backend
| Технология | Версия | Назначение |
|------------|--------|------------|
| **Java** | 25 | Язык программирования |
| **Quarkus** | 3.31.1 | REST API фреймворк |
| **Hibernate Panache** | - | ORM для работы с БД |
| **SmallRye JWT** | - | JWT аутентификация |
| **Flyway** | - | Миграции базы данных |
| **GigaChat Java SDK** | 0.1.10 | API для генерации embeddings |

### База данных и кеширование
| Технология | Версия | Назначение |
|------------|--------|------------|
| **PostgreSQL** | 16 | Реляционная СУБД |
| **pgvector** | latest | Векторное расширение для семантического поиска |
| **Redis** | 7 | Кеширование query embeddings и деталей проектов |

### Инфраструктура
| Технология | Назначение |
|------------|------------|
| **Docker Compose** | Оркестрация PostgreSQL и Redis |
| **Google OIDC** | SSO авторизация (опционально) |

---

## 🏗️ Архитектура

### Общая схема

```
┌─────────────────────────────────────────────────────────────────┐
│                         FRONTEND (React)                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   Catalog    │  │  My Apps     │  │  Admin Panel │           │
│  │   Page       │  │  Dashboard   │  │              │           │
│  └──────────────┘  └──────────────┘  └──────────────┘           │
│         │                  │                  │                  │
│         └──────────────────┴──────────────────┘                  │
│                            │                                     │
│                      Vite Proxy (/api/*)                         │
└────────────────────────────┬────────────────────────────────────┘
                             │ HTTP/JSON + JWT
┌────────────────────────────┴────────────────────────────────────┐
│                    BACKEND (Quarkus REST API)                    │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  Resources (Controllers)                                  │  │
│  │  ProjectResource │ ApplicationResource │ AdminResource    │  │
│  └────────┬──────────────────┬─────────────────────┬──────────┘  │
│           │                  │                     │             │
│  ┌────────┴──────────────────┴─────────────────────┴──────────┐  │
│  │  Services                                                  │  │
│  │  ProjectSearchService │ QueryEmbeddingCache │ GigaChat    │  │
│  └────────┬───────────────────┬───────────────────────────────┘  │
│           │                   │                                  │
│  ┌────────┴───────────────────┴──────────────────────────────┐  │
│  │  Entities (Panache ORM)                                   │  │
│  │  User │ Project │ Application │ Question │ Answer         │  │
│  └────────┬──────────────────────────────────────────────────┘  │
└───────────┼──────────────────────────────────────────────────────┘
            │
    ┌───────┴────────┐
    │                │
┌───┴────────┐  ┌────┴─────┐
│ PostgreSQL │  │  Redis   │
│    + pgvec │  │  Cache   │
└────────────┘  └──────────┘
```

### Ключевые архитектурные решения

#### ✅ Плюсы

1. **Монорепозиторий**
   - Единая кодовая база для frontend и backend
   - Упрощенная синхронизация изменений
   - Общая документация и CI/CD

2. **Quarkus Framework**
   - Быстрый старт приложения (~1-2 секунды)
   - Низкое потребление памяти
   - Dev Mode с live reload
   - Встроенная поддержка виртуальных потоков (Java 21+)

3. **Hibernate Panache**
   - Active Record паттерн — упрощенная работа с БД
   - Меньше boilerplate кода
   - Автоматическая генерация SQL

4. **Redis кеширование**
   - Query embeddings кешируются на 7 дней (детерминированы)
   - Детали проектов кешируются на 1 час
   - Ускорение API в 200-1000 раз для повторных запросов

5. **Семантический поиск с GigaChat**
   - Интеллектуальный поиск по смыслу, а не только по ключевым словам
   - Гибридный RRF (Reciprocal Rank Fusion) для комбинирования традиционного и семантического поиска
   - SIMD-оптимизация вычислений через Java Vector API

6. **JWT аутентификация**
   - Stateless — не требует хранения сессий на сервере
   - Легко масштабируется горизонтально
   - Интеграция с Google OIDC

7. **Dev Auth режим**
   - Быстрая разработка без настройки Google OAuth
   - Возможность тестировать любую роль

#### ⚠️ Потенциальные недостатки

1. **Монорепозиторий**
   - ❌ Сложнее разделить команды (frontend/backend)
   - ❌ Общие зависимости могут конфликтовать
   - ✅ **Решение**: Четкая структура папок, изоляция зависимостей

2. **Java 25 (preview features)**
   - ❌ Требует флаги `--enable-preview --add-modules jdk.incubator.vector`
   - ❌ Не все IDE корректно поддерживают preview features
   - ✅ **Решение**: Документация с инструкциями для IntelliJ/VSCode

3. **Без TypeScript на frontend**
   - ❌ Нет статической типизации
   - ❌ Больше runtime ошибок
   - ✅ **Решение**: JSDoc комментарии, строгие PropTypes (опционально)

4. **Ручная инвалидация кеша**
   - ❌ Риск забыть добавить `@CacheInvalidate`
   - ✅ **Решение**: Code review, интеграционные тесты

5. **Семантический поиск**
   - ❌ Зависимость от внешнего API (GigaChat)
   - ❌ Дополнительная латентность (~500-2000ms без кеша)
   - ✅ **Решение**: Redis кеширование, fallback на традиционный поиск

6. **Без CASCADE в БД**
   - ❌ Удаление связанных данных реализовано в коде
   - ❌ Риск orphaned records при ошибках
   - ✅ **Решение**: Транзакции, тесты на удаление

---

## 👥 Роли и права доступа

| Роль | Доступные действия |
|------|-------------------|
| **STUDENT** | • Просмотр опубликованных проектов<br>• Подача заявок на проекты<br>• Задавать вопросы (публичные и приватные)<br>• Просмотр своих заявок и обратной связи |
| **MENTOR** | • Все права STUDENT<br>• Создание, редактирование, публикация проектов<br>• Просмотр и управление заявками на свои проекты<br>• Ответы на вопросы студентов<br>• Выдача обратной связи утвержденным студентам |
| **TEACHER** | • Просмотр опубликованных проектов<br>• Задавать вопросы менторам<br>• **Не могут:** подавать заявки, создавать проекты |
| **ADMIN** | • **Полный доступ** ко всем функциям<br>• Управление пользователями (изменение ролей)<br>• Модерация всех проектов<br>• Управление Allow List |

---

## ⚡ Быстрый старт

### Требования

- **Docker** и **Docker Compose**
- **Java 25** (рекомендуется через [SDKMAN](https://sdkman.io/): `sdk install java 25-open`)
- **Maven** 3.9+ (обычно идет с Java)
- **Node.js** 18+ и **npm**

### 1. Клонирование репозитория

```bash
git clone <repository-url>
cd sberlab-hub
```

### 2. Запуск инфраструктуры (PostgreSQL + Redis)

```bash
cd infra
docker compose up -d
```

Проверка:
```bash
docker compose ps
# Должны быть запущены: sberlab-postgres, sberlab-redis
```

### 3. Запуск Backend

```bash
cd ../backend

# Создать .env файл (если его нет)
cp .env.example .env

# Запустить в dev режиме
./mvnw quarkus:dev
```

Backend будет доступен по адресу: **http://localhost:8080**

Swagger UI: **http://localhost:8080/q/swagger-ui**

### 4. Запуск Frontend

```bash
cd ../frontend

# Установить зависимости
npm install

# Создать .env файл (если его нет)
cp .env.example .env

# Запустить dev сервер
npm run dev
```

Frontend будет доступен по адресу: **http://localhost:5173**

### 5. Вход в систему

По умолчанию включен **DEV_AUTH** режим:

- Откройте http://localhost:5173
- На странице входа введите любой email и выберите роль
- Нажмите "Войти"

Тестовые пользователи (создаются автоматически):
- `admin@example.com` — ADMIN
- `mentor@example.com` — MENTOR
- `student@example.com` — STUDENT
- `teacher@example.com` — TEACHER

---

## 📚 Документация

Подробная документация находится в папке `docs/`:

- **[Архитектура](docs/ARCHITECTURE.md)** — детальное описание архитектуры, технологий, плюсов и минусов
- **[Установка](docs/INSTALLATION.md)** — пошаговая инструкция по установке и настройке
- **[Разработка](docs/DEVELOPMENT.md)** — руководство для разработчиков, conventions, тестирование
- **[API](docs/API.md)** — документация REST API эндпоинтов с примерами

---

## 📁 Структура проекта

```
sberlab-hub/
├── backend/                      # Backend (Quarkus)
│   ├── src/
│   │   ├── main/
│   │   │   ├── java/org/acme/
│   │   │   │   ├── entity/      # JPA Entities (User, Project, Application...)
│   │   │   │   ├── dto/         # Data Transfer Objects
│   │   │   │   ├── resource/    # REST Controllers
│   │   │   │   ├── service/     # Business Logic
│   │   │   │   ├── event/       # CDI Events
│   │   │   │   ├── util/        # Utilities (VectorUtils, ...)
│   │   │   │   └── validation/  # Custom Validators
│   │   │   └── resources/
│   │   │       ├── db/migration/ # Flyway SQL migrations
│   │   │       ├── application.properties
│   │   │       ├── privateKey.pem
│   │   │       └── publicKey.pem
│   │   └── test/                # Unit tests
│   ├── pom.xml
│   └── .env                     # Environment variables
│
├── frontend/                     # Frontend (React)
│   ├── public/
│   │   └── logos/               # Sberbank, NSU, SberTech logos
│   ├── src/
│   │   ├── components/          # React components (Layout, ProtectedRoute)
│   │   ├── pages/               # Page components
│   │   ├── AuthContext.jsx      # Auth state management
│   │   ├── LanguageContext.jsx  # i18n (EN/RU)
│   │   ├── ThemeContext.jsx     # Dark/Light mode
│   │   ├── SnackbarContext.jsx  # Toast notifications
│   │   ├── translations.js      # Translation strings
│   │   ├── api.js               # API client
│   │   ├── App.jsx              # Routes
│   │   └── main.jsx             # Entry point
│   ├── package.json
│   ├── vite.config.js
│   └── .env                     # Environment variables
│
├── infra/
│   └── docker-compose.yml       # PostgreSQL + Redis
│
├── docs/                         # Documentation
│   ├── ARCHITECTURE.md
│   ├── INSTALLATION.md
│   ├── DEVELOPMENT.md
│   └── API.md
│
├── README.md                     # Этот файл
└── CLAUDE.md                     # Instructions for Claude Code
```

